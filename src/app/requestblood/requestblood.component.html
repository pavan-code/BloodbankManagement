<div class="container">
    <div class="form" >
        <h2>Request for Blood</h2>
        <div class="spin" *ngIf = "hide">
            <mat-spinner diameter='100' strokeWidth='3'></mat-spinner> <br>
            <p>Submitting blood request..</p>
        </div>
        <form action="" [formGroup]="request" *ngIf = "!hide">
            <h3>Patient Details</h3>
            <div class="form-group">
                <label for="patient">Patient Name</label>
                <input type="text" class="form-control" formControlName = "patient">
                <small *ngIf = "formErrors.patient">
                    {{formErrors.patient}}
                </small>                
            </div>
            <div class="form-group">
                <label for="blood">Blood Group</label>
                <select class="form-select form-control" name="blood" id="blood" formControlName = "blood">
                    <option value="" selected>--Select Blood--</option>
                   <option value="{{blood}}" *ngFor = "let blood of bloods">
                       {{blood}}
                   </option>
                </select>
                <small *ngIf = "formErrors.blood">
                    {{formErrors.blood}}
                </small>                
            </div>
            <div class="form-group">
                <label for="state">State</label>
                <select (change)="changeState($event)" name="state" id="state" class="form-control" formControlName = "state">
                    <option value="" selected>--Select State--</option>
                    <option value="{{state.name}}" *ngFor = "let state of states">
                        {{state.name}}
                    </option>   
                </select>
                <small *ngIf = "formErrors.state">
                    {{formErrors.state}}
                </small>                
            </div>
            <div class="form-group">
                <label for="district">District</label>
                <select name="district" id="district" class="form-control" formControlName = "district">
                    <option value="" selected>--Select District--</option>
                    <option value="{{district}}" *ngFor = "let district of districts">
                        {{district}}
                    </option>
                </select>
                <small *ngIf = "formErrors.district">
                    {{formErrors.district}}
                </small>                
            </div>
            <div class="form-group">
                <label for="mobile">Mobile</label>
                <input type="text" name="mobile" id="mobile" class="form-control" formControlName = "mobile">
                <small *ngIf = "formErrors.mobile">
                    {{formErrors.mobile}}
                </small>                
            </div>
            <div class="form-group">
                <label for="email">Email</label>
                <input type="text" name="email" id="email" class="form-control" formControlName = "email">
                <small *ngIf = "formErrors.email">
                    {{formErrors.email}}
                </small>                
            </div>
            <div class="form-group">
                <label for="date">Required by date</label>
                <input type="date" name="date" id="date" class="form-control" formControlName = "date">
                <small *ngIf = "formErrors.date">
                    {{formErrors.date}}
                </small>                
            </div>
            <div class="form-group">
                <label for="priority">Priority</label>
                <select name="priority" id="priority" class="form-control" formControlName = "priority">
                    <option value="" selected>--Select Priority--</option>
                    <option value="urgent">Urgent</option>
                    <option value="normal">Normal</option>
                </select>
                <small *ngIf = "formErrors.priority">
                    {{formErrors.priority}}
                </small>                
            </div>
            <div>
                <button (click)="submit()" [disabled] = "request.invalid" mat-stroked-button>Submit</button>
            </div>
        </form>
    </div>
    <div class="requests">
        <h2>Blood requests for patients</h2>
        <div class="spin" *ngIf = "show">
            <mat-spinner diameter='100' strokeWidth='3'></mat-spinner> <br>
            <p>Getting blood requests..</p>
        </div>
        <div class="scroll" *ngIf = !show>        
            <mat-card *ngFor = "let request of requests">
                <mat-card-content> 
                    <div class="group">
                        {{request.blood}}
                    </div>
                    <div class="details">
                        <p><b> {{request.patient | titlecase}} </b></p>
                        <p> +91 {{request.mobile}} </p>
                    </div>
                    <div class="contact">
                        <p><b>Required by:</b></p>
                        <p> {{request.date | date:"mediumDate"}} </p>
                    </div>
                </mat-card-content>            
            </mat-card>
        </div>
    </div>
</div>